---
title: "Tarea 3 11/22 Modelaje"
author: "Francisco Alfonso Perez Storms"
date: "13/11/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

```

```{r}
#library(deSolve)
```

En los problemas analíticos no pongas valores a los par ́ametros. Repito NO 
pongas valores a lo par ́ametros. Solo ausme que todos son positivos. Para
los problemas computacionales debes poner valores a los par ́ametros para poder
resolverlos.

### 1. 
Encuentra el numero reproductivo basico R0 para el siguiente modelo.
Encuentra el punto de equilibrio endemico.

```{r}
$$
\begin{aligned}
\dot{S} &=&-\beta S I+\alpha I \\
\dot{I} &=& \beta S I-(\alpha+delta) I
\end{aligned}
$$
```

Obtenemos el R0 y obtenemos los valores para obtener los puntos de equilibrio
```{r}
$$
\begin{array}{l}
R_0=\frac{\beta}{\alpha+d} \\
\dot{S}=I(-\beta S+\alpha) \\
I=0 \\
S=\alpha / \beta \\
\dot{I}=I(\beta S-(\alpha+\delta)) \\
\dot{I}=0 \\
S=(\alpha + \delta) / \beta=1 / R_0
\end{array}
$$
```
Evaluamos los puntos de equilibrio
```{r}
$$
\begin{array}{r}
\dot{S} : \dot{I}=S\dot = (\alpha+\delta) / \beta \\
-\beta \frac{\alpha + \delta}{\beta}+\alpha=0 \\
\quad \delta=0 \\
\dot{I} : \dot{S}=S=\alpha / \beta \\
\beta \frac{\alpha}{\beta}-(\alpha + \delta)=0\\
\quad\delta=0\\
\\
x = (S,I)\\
x_1=(0,0) \\
x_2=\left(\alpha+\delta/ \beta,0) \delta=0\right. \\
x_3=(\alpha / \beta, 0)
\end{array}
$$
```
Agrega a tu modelo tasas de nacimiento y muertes naturales. Demuestra
que el punto de equilibrio free-disease es asintoticamente estable con R0 <
1 y el punto de equilibrio endemico lo es con R0 > 1. Explica y discute tu
resultado.

Modelo y formulas del modelo con tasas de nacimiento y muertes naturales
```{r}
$$
\dot{S}_{\alpha+\nu}^{\mu+\beta(SI)}\rightarrow \dot{I}_{\beta(SI)}^{\mu + \delta + \alpha}
$$

$$
\begin{array}{l}
\dot{S}=-\beta(S I)+\alpha I+\nu-\mu S \\
\dot{I}=\beta(S I)-(\mu+\delta+\alpha) I
\end{array}
$$
```
NO SÉ, como demostrar que el punto de equilibrio es free-disease es 
asintoticamente estable con R0<1 y el punto de equilibrio endemico 
lo es con R0 > 1.

Sé que el R0 es un punto de bifurcación, y que esta relacionado con la
eficiencia del patogeno para dispersarse en la población. Sí es menor a 0
Es seguro que llegara un punto en el que los I estaran en 0, como se demuestra
con todos los puntos de equilibrio obtenidos, más, si esta en mayor a 1, entonces
habra una fracción de I que se mantendra a traves del tiempo. 

### 2. 
Considera una enfermedad transmisible en la cual los infectados no se
recuperan. Discute porque dicha enfermedad puede ser modelada por el
siguiente conjunto de ecuaciones diferenciales


```{r}
$$
\dot{S}^{\beta(SI)}\rightarrow \dot{I}_{\beta(SI)}
$$

$$
\begin{array}{l}
\dot{S}=-\beta(S I)\\
\dot{I}=\beta(S I)
\end{array}
$$
```
Con este modelo se representa una enfermedad transmisible 
en la que los infectados no se recuperan porque no hay un 
compartimento de recuperados, ni una tasa que los regrese 
a ser suceptibles.

Si la población de suceptibles es de 10^999, y solo 1 infectado,
a partir de una beta de .01, tardaría mucho en que los suceptibles
pasen a ser infectados porque el flujo es muy chiquito y la población
es muy grande, más al final todos terminarian en el compartimento de infectados.
Si tuvieramos tasa de muerte natural y natalidad, unicamente los que mueren en 
el compartimento de suceptibles,-puede ser-, que no se contagiarian
o pasarian a ser infectados.

### 3
Considera un modelo b ́asico SIR al que le agregaremos la clase de vacu-
nados en lugar de los recuperados. Discute porque dicho modelo puede
representarse por el siguiente conjunto de ecuaciones diferenciales

```{r}
$$
\begin{aligned}
\dot{S} &=\mu N-\beta \frac{S I}{N}-(\mu +\phi ) S \\
\dot{I} &=\quad \beta \frac{S I}{N}-(\mu +\gamma ) I \\
\dot{V} &=\gamma I+\phi S-\mu V \\
\operatorname{con} N(t)=S(t)+I(t) &+V(t)
\end{aligned}
$$
```
El modelo incluye las variables y parametros para un sistema abierto 
de suceptibles, infectados y vacunados, considerando que el contagio
de la enfermedad es dependiente de la frecuencia con que pueden
interactuar los infectados con los suceptibles.

(a) Dibuja un modelo por compartimentos que represente al conjunto de
ecuaciones diferenciales
```{r}
$$
\dot{S}_{\nu (N)}^{\mu +\phi +\beta ((SI)/N)}\rightarrow \dot{I}_{\beta ((SI)/N)}^{\mu +\gamma }\rightarrow \dot{V}_{\gamma (I)+phi (S)}^{\mu }
$$
```

(b) Demuestra que \dot{N} = 0.¿Que significa este resultado?
Sí \dot{N} = 0, quiere decir que tanto \dot{S}, \dot{I} y \dot{V} no hay
población, por lo tanto estamos en el punto de equilibrio de (0,0,0),
por lo tanto no individuos ni enfermedad en la "población", porque no hay
población.

(c) Discute porque es suficiente con estudiar las dos primeras ecuaciones
para resolver el sistema.
Podemos reducir 1D, para poder simplificar el modelo y sea más facil su 
interpretación, agregado a que no estamos perdiendo información, a no ser que 
no sea muy relevante conocer la cantidad de individuos que llegan al comparti-
mento de vacunados. Agregado a que podemos considerar que es un sistema cerrado
porque la población total se mantiene, por lo tanto podriamos simplificarlo aun
mas al quitar las tasas de natalidad y muerte.

Este es el sistema de ecuaciaciones que obtendriamos
```{r}
$$
\begin{array}{l}
\dot{S}=-\beta S I-\phi S \\
I=\beta S I- \gamma I
\end{array}
$$
```

(d) Calcula los puntos de equilibrio y determina sus estabilidades.
```{r}
$$
\begin{array}{l}
R_0= \gamma / \beta \\
\dot{S}=S(-\beta I-\phi) \\
S=0\\
I=-\phi / \beta \\
\\
\dot{I}=I(\beta S-\gamma) \\
I=0 \\
S=\gamma / \beta=R_0 \\
\\
x=(S, I) \\
x_1=(0,0) \\
x_2=(0,-\phi / \beta) \\
x_3=(\gamma / \beta, 0)
\end{array}
$$
```
No sé como evaluar sus estabilidades

### 4. 
Considera un modelo SIRS sin demografia.

(a) Escribe un esquema por compartimentos que lo describa , asi como
las ecuaciones diferenciales correspondientes.
```{r}
$$
\dot{S}_{\nu (N)}^{\mu +\phi +\beta ((SI)/N)}\rightarrow \dot{I}_{\beta ((SI)/N)}^{\mu +\gamma }\rightarrow \dot{V}_{\gamma (I)+phi (S)}^{\mu }
$$
```

(b) Describe los terminos y explica el signifcado de cada parametro.

(c) Reduce el sistema a dos ecuaciones diferenciales. ¿Porque puedes
hacer esto?

(d) Encuentra los puntos de equilibrio free-disease (I = 0) y endemico
(I distinto de 0) y determina sus estabilidades.
